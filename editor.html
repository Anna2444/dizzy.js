<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
        <title>Dizzy Editor</title>

		<script type="text/javascript" src="./js/jquery/jquery.js"></script>
		<script type="text/javascript" src="./js/jquery/jquery.mousewheel.min.js"></script>
		<script type="text/javascript" src="./js/jquery/svg/jquery.svg.js"></script>
		<script type="text/javascript" src="./js/jquery/svg/jquery.svganim.js"></script>
		<script type="text/javascript" src="./js/jquery/svg/jquery.svgdom.js"></script>
		
		<script type="text/javascript" src="./js/jquery/jquery-ui.min.js"></script>
		
		<script type="text/javascript" src="./js/jquery/base64.js"></script>
	
        <script type="text/javascript" src="./js/dizzy.js"></script>
		<script type="text/javascript" src="./js/dizzy.editor.js"></script>
		
        <link type="text/css" rel="stylesheet" href="./css/editor.css"/>
        <link type="text/css" rel="stylesheet" href="./css/smoothness/jquery-ui-1.8.9.custom.css"/>
	<script>
		$(
			function(){
				$('#dizzy').height($(document).height());
				$('#dizzy').width($(document).width());
				var dizz = new Dizzy('#dizzy', {zoomable: true, pannable: true, transformTime: 1000, zoomFactor: 2} );
				dizz.load('./images/blank.svg', 
					function(){ 
						dizz.show(0);
						dizz.editor(true); 
					} );
					
					
				// menubar effects
				var inBar = false;
				var bar = $('#menubar');
				bar.bind( {
						mouseenter: (function(ev){ inBar = true; bar.animate({height:'40px'}, 500); }),
						mouseleave: (function(ev){ inBar = false;setTimeout(hideMenuBar, 1000 ); })
						}
				);
				function hideMenuBar(){
					if( inBar === false ){
				 		bar.animate({height:'10px' }, 500);
				 	}
				}
				
				$('#openButton').bind('click', 
					function(){
						alert('Sorry, due to some cross-browser issues not implemented yet. ):')
					}
				);
				
				$('#saveButton').bind('click', 
					function(){ 
						var svgProlog = '<?xml version="1.0"?>';//+
						//'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">';
						
						var svgText = dizz.serialize();
						var svgBase64 = 'data:image/svg+xml;charset=utf-8;base64,'+$.base64Encode (svgProlog+svgText);
						window.open(svgBase64) 
					});
				$('#presentToggleButton').toggle(
					function(){ 
						dizz.editor(false); 
						$('#presentToggleText').text('Edit'); 
						$('#leftrightButtons').fadeToggle('slow'); 
					},
					function(){ 
						dizz.editor(true); 
						$('#presentToggleText').text('Present'); 
						$('#leftrightButtons').fadeToggle('slow'); 
					}
				);
				

				$('#helpButton').bind('click', 
					function(){
						$('#helpDialog').dialog({modal:true});
					}
				);
				
				$('#aboutButton').bind('click', 
					function(){
						$('#aboutDialog').dialog({modal:true});

					}
				);
				
				// next
				$('#left').click( function(){ dizz.previous(); } );
				//previous
				$('#right').click( function(){ dizz.next(); } );
			});

	</script>
    </head>
    <body style="height: 100%">
	<div id="dizzy"></div>
	
	<div id="menubar" class="ui-state-default">
			<div class="menuItem" id="openButton"><img src="./images/menu_open.gif" /> Open</div>
			<div class="menuItem" id="saveButton"><img src="./images/menu_save.gif" /> Save</div>
			<div class="menuItem" id="presentToggleButton">
				<img src="./images/menu_present.gif" /> <span id="presentToggleText">Present</span>
			</div>
			<div class="menuItem" id="helpButton"><img src="./images/menu_help.gif" /> Help?</div>
			<div class="menuItem" id="aboutButton"><img src="./images/menu_about.gif" /> About</div>
	</div>
	
	<!-- <div id="help">Help?</div> -->
	<div id="helpNote">stuff, blabla</div>
	<div id="leftrightButtons">
		<div id="left">&lt; </div> <div id="right"> &gt;</div>
	</div>
	
	

	<div id="helpDialog" class="invisible" title="Help">
	
		Helptext...
	</div>
	<div id="aboutDialog" class="invisible"title="About Dizzy">
		Dizzy
		
		The good-looking icons on this page are from the silk icon set by famfamfam.com.. 
		(the ugly ones I made myself).
	</div>
	
    </body>
</html>